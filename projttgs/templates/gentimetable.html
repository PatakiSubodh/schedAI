{% load static %}
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>SchedAI</title>
    <link rel="icon" type="image/png" href="/projttgs/assets/img/favicon.png">
    
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
	<script src="https://use.fontawesome.com/releases/v5.0.8/js/all.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.js"></script>
    <style>
		:root {
			--primary-color: #5a5a5a;
			--secondary-color: #257a7a;
			--background-color: #fff;
			--font-family: 'Times New Roman', serif;
		}
		body {
			font-family: var(--font-family);
		}
		h1, h2 {
			text-align: center;
		}
		.table-schedule {
			margin: 20px auto;
			width: 90%;
			border-collapse: collapse;
		}
		.table-schedule th, .table-schedule td {
			border: 2px solid var(--primary-color);
			text-align: center;
			padding: 10px;
		}
		.table-schedule th {
			background-color: var(--primary-color);
			color: white;
            border: 1px solid rgb(0, 0, 0);
		}
		.table-schedule td {
			background-color: var(--background-color);
		}
		.btn-download {
			display: block;
			margin: 20px auto;
			padding: 10px 30px;
			color: #fff;
			background-color: var(--primary-color);
			border: none;
			border-radius: 5px;
			font-size: 16px;
			cursor: pointer;
		}
		.btn-download:hover {
			background-color: var(--secondary-color);
		}

	</style>
</head>
<body>
    <div id="timetable">
        <div style="background-color: #5a5a5a; padding: 15px 0;">
            <a href="{% url 'admindash' %}"><h1 style="font-size: 3rem; color: #fff;">SchedAI</h1></a>
        </div>
        <!-- <hr style="border: 1px solid black;"> -->
        <br>
        {% block content %}
        {% if sections %}
            {% for section in sections %}
                <h2>{{ section.section_id }} ({{ section.department }})</h2>

                <div class="table-responsive">
                    <table class="table-schedule" style="font-size: 1.2rem;">
                        <thead>
                            <tr>
                                <th>Day</th>
                                <th>1<br>(08:50 - 09:50)</th>
                                <th>2<br>(09:50 - 10:45)</th>
                                <th>3<br>(11:00 - 11:55)</th>
                                <th>4<br>(11:55 - 12:50)</th>
                                <th style="background-color: white; border: none; border-top: 1px solid black;"></th>
                                <th>5<br>(02:00 - 03:00)</th>
                                <th>6<br>(03:00 - 04:00)</th>
                                <th>7<br>(04:00 - 05:00)</th>
                            </tr>
                        </thead>
                        <tbody>

                            <!-- Monday -->
                            <tr>
                                <td>Monday</td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 'm1' and  class.meeting_time.time == '08:50 - 09:50' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 'm2' and  class.meeting_time.time == '09:50 - 10:45' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 'm3' and  class.meeting_time.time == '11:00 - 11:55' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 'm4' and  class.meeting_time.time == '11:55 - 12:50' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td rowspan="6" style="writing-mode: vertical-rl; font-weight: bold; font-size: 1.25rem; border: none; border-bottom: 1px solid;">lunch break</td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 'm5' and  class.meeting_time.time == '14:00 - 15:00' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 'm6' and  class.meeting_time.time == '15:00 - 16:00' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 'm7' and  class.meeting_time.time == '16:00 - 17:00' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                            </tr>
                            
                            <!-- Tuesday -->
                            <tr>
                                <td>Tuesday</td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 't1' and  class.meeting_time.time == '08:50 - 09:50' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 't2' and  class.meeting_time.time == '09:50 - 10:45' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 't3' and  class.meeting_time.time == '11:00 - 11:55' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 't4' and  class.meeting_time.time == '11:55 - 12:50' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 't5' and  class.meeting_time.time == '14:00 - 15:00' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 't6' and  class.meeting_time.time == '15:00 - 16:00' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 't7' and  class.meeting_time.time == '16:00 - 17:00' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                            </tr>
                            
                            <!-- Wednesday -->
                            <tr>
                                <td>Wednesday</td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 'w1' and  class.meeting_time.time == '08:50 - 09:50' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 'w2' and  class.meeting_time.time == '09:50 - 10:45' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 'w3' and  class.meeting_time.time == '11:00 - 11:55' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 'w4' and  class.meeting_time.time == '11:55 - 12:50' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 'w5' and  class.meeting_time.time == '14:00 - 15:00' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 'w6' and  class.meeting_time.time == '15:00 - 16:00' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 'w7' and  class.meeting_time.time == '16:00 - 17:00' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                            </tr>
                            
                            <!-- Thursday -->
                            <tr>
                                <td>Thursday</td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 'th1' and  class.meeting_time.time == '08:50 - 09:50' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 'th2' and  class.meeting_time.time == '09:50 - 10:45' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 'th3' and  class.meeting_time.time == '11:00 - 11:55' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 'th4' and  class.meeting_time.time == '11:55 - 12:50' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 'th5' and  class.meeting_time.time == '14:00 - 15:00' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 'th6' and  class.meeting_time.time == '15:00 - 16:00' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 'th7' and  class.meeting_time.time == '16:00 - 17:00' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                            </tr>
                            
                            <!-- Friday -->
                            <tr>
                                <td>Friday</td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 'f1' and  class.meeting_time.time == '08:50 - 09:50' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 'f2' and  class.meeting_time.time == '09:50 - 10:45' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 'f3' and  class.meeting_time.time == '11:00 - 11:55' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 'f4' and  class.meeting_time.time == '11:55 - 12:50' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 'f5' and  class.meeting_time.time == '14:00 - 15:00' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 'f6' and  class.meeting_time.time == '15:00 - 16:00' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 'f7' and  class.meeting_time.time == '16:00 - 17:00' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                            </tr>
                            
                            <!-- Saturday -->
                            <tr>
                                <td>Saturday</td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 's1' and  class.meeting_time.time == '08:50 - 09:50' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 's2' and  class.meeting_time.time == '09:50 - 10:45' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 's3' and  class.meeting_time.time == '11:00 - 11:55' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 's4' and  class.meeting_time.time == '11:55 - 12:50' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 's5' and  class.meeting_time.time == '14:00 - 15:00' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 's6' and  class.meeting_time.time == '15:00 - 16:00' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for class in schedule %}
                                        {% if class.section == section.section_id and class.meeting_time.pid == 's7' and  class.meeting_time.time == '16:00 - 17:00' %}
                                            {{ class.course.course_name }}<br>({{ class.instructor.name }})
                                        {% endif %}
                                    {% endfor %}
                                </td>
                            </tr>



                        </tbody>
                    </table>
                    <hr style="border: 1px solid black;">
                </div>
            {% endfor %}
            {% else %}
                <p>No timetable data is available.</p>
            {% endif %}
        {% endblock %}
    </div>

    <div style="display: flex; justify-content: center;">   
        <button class="btn btn-success" id="download" style="padding: 15px 40px; font-size: 1.25rem;">Download PDF</button>
    </div><br><br>

    <script>
        document.getElementById("download").addEventListener("click", () => {
            const timetable = document.getElementById("timetable");
            if (!timetable) {
                alert("Timetable not found!");
                return;
            }
            const options = {
                filename: 'SchedAI_timetable.pdf',
                jsPDF: { unit: 'in', format: 'a4', orientation: 'landscape' }
            };
            html2pdf().from(timetable).set(options).save();
        });
    </script>
    
</body>
</html>